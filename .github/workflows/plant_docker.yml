name: Generate PlantUML state diagram (Docker)

on:
  push:
    paths:
      - "state.puml"
      - ".github/workflows/plantuml-state-docker.yml"
  workflow_dispatch:

jobs:
  render-state-diagram:
    runs-on: ubuntu-latest

    steps:
      # 1. Repo auschecken
      - name: Check out repository
        uses: actions/checkout@v4

      # 2. PlantUML via Docker ausf√ºhren
      - name: Generate PNG from state.puml with Docker
        run: |
          docker run --rm \
            -v "${{ github.workspace }}:/data" \
            plantuml/plantuml \
            -tpng state.puml

      # 3. PNG als Artifact hochladen
      - name: Upload diagram artifact
        uses: actions/upload-artifact@v4
        with:
          name: state-diagram
          path: state.png
